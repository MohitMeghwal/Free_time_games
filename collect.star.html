<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<title>Collect the Stars</title>
<style>
  html, body {
    margin: 0;
    padding: 0;
    background: #000;
    overflow: hidden;
    touch-action: manipulation;
    font-family: Arial, sans-serif;
  }
  canvas {
    display: block;
    background: linear-gradient(#87ceeb, #fff);
  }
  .overlay {
    position: fixed;
    top: 0; left: 0;
    width: 100vw; height: 100vh;
    background: rgba(0,0,0,0.85);
    color: #fff;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    z-index: 10;
    text-align: center;
  }
  button {
    padding: 12px 24px;
    font-size: 18px;
    background: #0ff;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    margin-top: 20px;
  }
  button:hover {
    background: #0cc;
  }
</style>
</head>
<body>

<canvas id="game"></canvas>

<div id="startScreen" class="overlay">
  <h1>ðŸŒŸ Collect the Stars ðŸŒŸ</h1>
  <p>Move the ðŸ—‘ to catch stars</p>
  <button onclick="startGame()">Start</button>
</div>

<div id="gameOverScreen" class="overlay" style="display:none;">
  <h2>Game Over</h2>
  <p id="scoreDisplay"></p>
  <p id="highScoreDisplay"></p>
  <button onclick="restartGame()">Restart</button>
</div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

let bucket, stars, score, speed, spawnRate, gameRunning, animationId;
let lastSpawn = 0;
let highScore = localStorage.getItem("collectHighScore") || 0;

// Adjust canvas to fullscreen
function resizeCanvas() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
  if (bucket) bucket.y = canvas.height - bucket.h - 10;
}
window.addEventListener("resize", resizeCanvas);
resizeCanvas();

function resetGame() {
  bucket = { x: canvas.width/2 - 30, y: canvas.height - 60, w: 60, h: 40 };
  stars = [];
  score = 0;
  speed = 2;
  spawnRate = 1000;
}

function spawnStar() {
  stars.push({
    x: Math.random() * (canvas.width - 30),
    y: -30,
    size: 30
  });
}

function drawBucket() {
  ctx.font = `${bucket.h}px Arial`;
  ctx.fillText("ðŸ—‘", bucket.x, bucket.y + bucket.h);
}

function drawStars() {
  for (let s of stars) {
    ctx.font = `${s.size}px Arial`;
    ctx.fillText("ðŸŒŸ", s.x, s.y + s.size);
  }
}

function update(timestamp) {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  // Spawn stars
  if (timestamp - lastSpawn > spawnRate) {
    spawnStar();
    lastSpawn = timestamp;
    if (spawnRate > 400) spawnRate -= 15;
    if (speed < 8) speed += 0.05;
  }

  // Move stars
  for (let i = stars.length - 1; i >= 0; i--) {
    stars[i].y += speed;
    // Collision check
    if (
      stars[i].y + stars[i].size >= bucket.y &&
      stars[i].x < bucket.x + bucket.w &&
      stars[i].x + stars[i].size > bucket.x
    ) {
      score++;
      stars.splice(i, 1);
    } else if (stars[i].y > canvas.height) {
      endGame();
      return;
    }
  }

  // Draw
  drawStars();
  drawBucket();

  // Score display
  ctx.fillStyle = "#fff";
  ctx.font = "20px Arial";
  ctx.fillText(`Score: ${score}`, 10, 30);

  animationId = requestAnimationFrame(update);
}

function moveBucket(e) {
  let x = e.touches ? e.touches[0].clientX : e.clientX;
  bucket.x = x - bucket.w / 2;
  if (bucket.x < 0) bucket.x = 0;
  if (bucket.x + bucket.w > canvas.width) bucket.x = canvas.width - bucket.w;
}

function startGame() {
  document.getElementById("startScreen").style.display = "none";
  document.getElementById("gameOverScreen").style.display = "none";
  resetGame();
  gameRunning = true;
  lastSpawn = performance.now();
  update(performance.now());
}

function endGame() {
  cancelAnimationFrame(animationId);
  gameRunning = false;

  if (score > highScore) {
    highScore = score;
    localStorage.setItem("collectHighScore", highScore);
  }

  document.getElementById("scoreDisplay").textContent = "Score: " + score;
  document.getElementById("highScoreDisplay").textContent = "High Score: " + highScore;
  document.getElementById("gameOverScreen").style.display = "flex";
}

function restartGame() {
  startGame();
}

canvas.addEventListener("mousemove", moveBucket);
canvas.addEventListener("touchmove", moveBucket);
</script>

</body>
</html>
